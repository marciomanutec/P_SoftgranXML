
SET SQL DIALECT 3; 

/* CREATE DATABASE 'C:\MyBackup\Projetos\Database\Firebird\P_SoftgranXML.FDB' PAGE_SIZE 4096 DEFAULT CHARACTER SET ISO8859_1; */

/*  Character sets */
ALTER CHARACTER SET ISO8859_1 SET DEFAULT COLLATION PT_BR;



COMMIT WORK;

/* Table: DOCUMENTO_EVENTO, Owner: SYSDBA */
CREATE TABLE DOCUMENTO_EVENTO (ID_EVENTO INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
        ID_DOCUMENTO INTEGER NOT NULL,
        DT_EVENTO TIMESTAMP NOT NULL,
        TIPO_EVENTO VARCHAR(30) CHARACTER SET ISO8859_1 NOT NULL,
        STATUS_ANTES VARCHAR(20) CHARACTER SET ISO8859_1,
        STATUS_DEPOIS VARCHAR(20) CHARACTER SET ISO8859_1 NOT NULL,
        MENSAGEM VARCHAR(255) CHARACTER SET ISO8859_1,
        DETALHE VARCHAR(2000) CHARACTER SET ISO8859_1,
        USUARIO VARCHAR(60) CHARACTER SET ISO8859_1 NOT NULL,
CONSTRAINT PK_DOCUMENTO_EVENTO PRIMARY KEY (ID_EVENTO));

/* Table: DOCUMENTO_NFE, Owner: SYSDBA */
CREATE TABLE DOCUMENTO_NFE (ID_DOCUMENTO INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
        CHAVE_ACESSO VARCHAR(44) CHARACTER SET ISO8859_1,
        NUMERO VARCHAR(12) CHARACTER SET ISO8859_1,
        SERIE VARCHAR(5) CHARACTER SET ISO8859_1,
        DT_EMISSAO TIMESTAMP,
        EMIT_CNPJ_CPF VARCHAR(14) CHARACTER SET ISO8859_1,
        EMIT_RAZAO VARCHAR(120) CHARACTER SET ISO8859_1,
        DEST_CNPJ_CPF VARCHAR(14) CHARACTER SET ISO8859_1,
        DEST_RAZAO VARCHAR(120) CHARACTER SET ISO8859_1,
        VL_TOTAL DECIMAL(15, 2),
        STATUS_PROC VARCHAR(20) CHARACTER SET ISO8859_1 NOT NULL,
        MSG_STATUS VARCHAR(255) CHARACTER SET ISO8859_1,
        ARQUIVO_NOME VARCHAR(200) CHARACTER SET ISO8859_1,
        XML_CONTEUDO BLOB SUB_TYPE TEXT SEGMENT SIZE 80 CHARACTER SET ISO8859_1,
        DT_IMPORTACAO TIMESTAMP NOT NULL,
CONSTRAINT PK_DOCUMENTO_NFE PRIMARY KEY (ID_DOCUMENTO));

/* Table: DOCUMENTO_NFE_ITEM, Owner: SYSDBA */
CREATE TABLE DOCUMENTO_NFE_ITEM (ID_ITEM INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL,
        ID_DOCUMENTO INTEGER NOT NULL,
        ITEM INTEGER NOT NULL,
        DESCRICAO VARCHAR(160) CHARACTER SET ISO8859_1 NOT NULL,
        NCM VARCHAR(8) CHARACTER SET ISO8859_1,
        QUANTIDADE DECIMAL(15, 4) NOT NULL,
        VL_UNITARIO DECIMAL(15, 2) NOT NULL,
        VL_TOTAL DECIMAL(15, 2) NOT NULL,
CONSTRAINT PK_DOCUMENTO_NFE_ITEM PRIMARY KEY (ID_ITEM));

/*  Index definitions for all user tables */
CREATE UNIQUE INDEX UX_DOC_CHAVE ON DOCUMENTO_NFE (CHAVE_ACESSO);
CREATE UNIQUE INDEX UX_ITEM_DOC ON DOCUMENTO_NFE_ITEM (ID_DOCUMENTO, ITEM);

ALTER TABLE DOCUMENTO_EVENTO ADD CONSTRAINT FK_EVT_DOC FOREIGN KEY (ID_DOCUMENTO) REFERENCES DOCUMENTO_NFE (ID_DOCUMENTO);

ALTER TABLE DOCUMENTO_NFE_ITEM ADD CONSTRAINT FK_ITEM_DOC FOREIGN KEY (ID_DOCUMENTO) REFERENCES DOCUMENTO_NFE (ID_DOCUMENTO);